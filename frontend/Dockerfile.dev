# 开发环境专用 Dockerfile - 支持热更新
FROM node:18-alpine

# 设置工作目录
WORKDIR /app

# 设置环境变量
ENV NODE_ENV=development
ENV CHOKIDAR_USEPOLLING=true
ENV NODE_OPTIONS="--max-old-space-size=2048"

# 复制package文件并安装依赖
COPY package*.json ./
RUN npm config set registry https://registry.npmmirror.com/ && \
    npm install

# 复制源代码（开发时会被volume覆盖）
COPY . .

# 暴露端口
EXPOSE 3000

# 开发模式启动，支持热更新
CMD ["npm", "run", "serve"]