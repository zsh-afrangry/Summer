# 博客系统数据库集成开发计划

## 📋 项目概述

将当前前端的静态数据全部连接到数据库，实现完整的博客系统后端API和前端集成。

### 🎯 目标
- 将BlogHome、BlogList、About页面的静态数据替换为数据库动态数据
- 设计并实现完整的后端API接口
- 实现文章管理、标签管理等核心功能
- 提供搜索、筛选、分页等高级功能

---

## 🗄️ 数据库设计分析

### 当前数据结构分析

#### 1. BlogHome.vue 静态数据
```javascript
latestArticles: [
  {
    id: 1,
    title: 'Vue3 + Spring Boot 全栈项目搭建指南',
    excerpt: '详细介绍如何从零开始搭建...',
    date: '2024-01-15',
    tags: ['Vue.js', 'Spring Boot', '全栈开发'],
    readTime: 8
  }
]
```

#### 2. BlogList.vue 静态数据
```javascript
articles: [
  {
    id: 1,
    title: 'Vue3 + Spring Boot 全栈项目搭建指南',
    summary: '详细介绍如何从零开始搭建...',
    date: '2024-01-15',
    tags: ['Vue.js', 'Spring Boot', '全栈开发'],
    readTime: 8,
    views: 156,
    likes: 23,
    comments: 5
  }
]
```

#### 3. About.vue 静态数据
- 个人基本信息
- 技能列表
- 联系方式
- 个人统计数据

### 需要设计的数据库表

#### 1. 文章表 (articles)
```sql
CREATE TABLE articles (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    excerpt TEXT,                    -- 摘要/简介
    content LONGTEXT,               -- 文章正文内容
    summary TEXT,                   -- 详细摘要
    author_id BIGINT,               -- 作者ID (关联用户表)
    status ENUM('DRAFT', 'PUBLISHED', 'ARCHIVED') DEFAULT 'DRAFT',
    views INT DEFAULT 0,            -- 浏览次数
    likes INT DEFAULT 0,            -- 点赞数
    comments_count INT DEFAULT 0,   -- 评论数
    read_time INT,                  -- 预估阅读时间(分钟)
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    published_at TIMESTAMP NULL,    -- 发布时间
    INDEX idx_status (status),
    INDEX idx_author (author_id),
    INDEX idx_published (published_at)
);
```

#### 2. 标签表 (tags)
```sql
CREATE TABLE tags (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL UNIQUE,
    color VARCHAR(7) DEFAULT '#667eea', -- 标签颜色
    description TEXT,
    article_count INT DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### 3. 文章标签关联表 (article_tags)
```sql
CREATE TABLE article_tags (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    article_id BIGINT NOT NULL,
    tag_id BIGINT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (article_id) REFERENCES articles(id) ON DELETE CASCADE,
    FOREIGN KEY (tag_id) REFERENCES tags(id) ON DELETE CASCADE,
    UNIQUE KEY unique_article_tag (article_id, tag_id)
);
```

#### 4. 个人信息表 (profile)
```sql
CREATE TABLE profile (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT NOT NULL,
    display_name VARCHAR(100),
    title VARCHAR(100),             -- 职位/头衔
    bio TEXT,                       -- 个人简介
    avatar_url VARCHAR(255),        -- 头像URL
    location VARCHAR(100),          -- 地址
    website VARCHAR(255),           -- 个人网站
    github VARCHAR(100),            -- GitHub用户名
    linkedin VARCHAR(100),          -- LinkedIn
    email VARCHAR(100),             -- 联系邮箱
    total_views INT DEFAULT 0,      -- 总浏览量
    total_articles INT DEFAULT 0,   -- 总文章数
    total_likes INT DEFAULT 0,      -- 总点赞数
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES user(id) ON DELETE CASCADE
);
```

#### 5. 技能表 (skills)
```sql
CREATE TABLE skills (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50) NOT NULL,
    category VARCHAR(50),           -- 技能分类 (前端/后端/工具等)
    proficiency INT DEFAULT 0,     -- 熟练度 (0-100)
    years_experience DECIMAL(3,1),  -- 使用年限
    description TEXT,
    is_featured BOOLEAN DEFAULT FALSE, -- 是否为特色技能
    sort_order INT DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## 🔧 后端API设计

### 1. 文章相关API

#### 文章基础CRUD
- `GET /api/articles` - 获取文章列表（支持分页、搜索、筛选）
- `GET /api/articles/{id}` - 获取文章详情
- `POST /api/articles` - 创建新文章
- `PUT /api/articles/{id}` - 更新文章
- `DELETE /api/articles/{id}` - 删除文章

#### 文章高级功能
- `GET /api/articles/latest` - 获取最新文章（首页用）
- `POST /api/articles/{id}/like` - 点赞文章
- `POST /api/articles/{id}/view` - 增加浏览量
- `GET /api/articles/search` - 搜索文章
- `GET /api/articles/by-tag/{tagName}` - 按标签筛选文章

### 2. 标签相关API
- `GET /api/tags` - 获取所有标签
- `GET /api/tags/popular` - 获取热门标签
- `POST /api/tags` - 创建新标签
- `PUT /api/tags/{id}` - 更新标签
- `DELETE /api/tags/{id}` - 删除标签

### 3. 个人信息API
- `GET /api/profile` - 获取个人信息
- `PUT /api/profile` - 更新个人信息
- `GET /api/skills` - 获取技能列表
- `POST /api/skills` - 添加新技能
- `PUT /api/skills/{id}` - 更新技能
- `DELETE /api/skills/{id}` - 删除技能

### 4. 统计信息API
- `GET /api/stats/overview` - 获取博客总体统计
- `GET /api/stats/articles` - 获取文章统计
- `GET /api/stats/tags` - 获取标签统计

---

## 📝 详细实施计划

### Phase 1: 基础设施搭建 ✅ (已完成)

#### ✅ TODO 1.1: 数据库实体设计 (已完成)
- ✅ 创建Article实体类
- ✅ 创建Tag实体类  
- ✅ 创建ArticleTag关联实体类
- ✅ 创建Profile实体类
- ✅ 创建Skill实体类
- ✅ 创建User实体类（补全字段）
- ✅ 创建ArticleStat实体类
- ✅ 创建SystemConfig实体类
- ✅ 配置JPA关联关系

#### ✅ TODO 1.2: Repository层实现 (已完成)
- ✅ UserRepository - 用户查询方法
- ✅ ArticleRepository - 文章查询方法（搜索、筛选、分页）
- ✅ TagRepository - 标签查询方法
- ✅ ProfileRepository - 个人信息查询
- ✅ SkillRepository - 技能查询
- ✅ ArticleStatRepository - 文章统计查询
- ✅ ArticleTagRepository - 文章标签关联查询
- ✅ SystemConfigRepository - 系统配置查询
- ✅ 实现自定义查询方法（搜索、筛选、统计）

**🔧 实现细节：**
- **完整的查询方法**：每个Repository都包含了基础CRUD、业务查询、统计查询
- **分页支持**：主要的查询方法都支持分页参数
- **搜索功能**：实现了模糊查询、全文搜索等功能
- **统计功能**：提供了各种统计查询方法
- **关联查询**：通过JPA关联实现复杂的多表查询
- **原子操作**：包含了增加浏览量、点赞等原子更新操作

**📝 重要代码亮点：**
```java
// 文章全文搜索
@Query("SELECT a FROM Article a WHERE a.status = 1 AND (a.title LIKE %:keyword% OR a.content LIKE %:keyword%)")
Page<Article> searchByTitleOrContent(@Param("keyword") String keyword, Pageable pageable);

// 原子更新浏览量
@Modifying
@Query("UPDATE ArticleStat s SET s.viewCount = s.viewCount + 1, s.lastViewAt = :viewTime WHERE s.article.id = :articleId")
void incrementViewCount(@Param("articleId") Long articleId, @Param("viewTime") Instant viewTime);

// 标签文章数量自动更新
@Modifying
@Query("UPDATE Tag t SET t.articleCount = (SELECT COUNT(at) FROM ArticleTag at WHERE at.tag.id = t.id)")
void updateAllArticleCounts();
```

#### ✅ TODO 1.3: Service层设计
- [ ] ArticleService - 文章业务逻辑
- [ ] TagService - 标签管理逻辑
- [ ] ProfileService - 个人信息管理
- [ ] SkillService - 技能管理逻辑

### Phase 2: 核心API实现 (预计3-4天)

#### ✅ TODO 2.1: 文章管理API
- [ ] 实现文章CRUD操作
- [ ] 文章列表查询（分页、排序）
- [ ] 文章搜索功能实现
- [ ] 文章标签关联处理

#### ✅ TODO 2.2: 标签管理API
- [ ] 标签CRUD操作
- [ ] 热门标签查询
- [ ] 标签文章统计

#### ✅ TODO 2.3: 个人信息API
- [ ] 个人资料管理
- [ ] 技能管理功能
- [ ] 统计数据计算

### Phase 3: 前端集成 (预计2-3天)

#### ✅ TODO 3.1: BlogHome页面改造
- [ ] 替换静态文章数据为API调用
- [ ] 实现最新文章动态加载
- [ ] 统计数据动态显示
- [ ] 错误处理和加载状态

#### ✅ TODO 3.2: BlogList页面改造
- [ ] 文章列表API集成
- [ ] 搜索功能实现
- [ ] 标签筛选功能
- [ ] 分页功能实现
- [ ] 排序功能添加

#### ✅ TODO 3.3: About页面改造
- [ ] 个人信息API集成
- [ ] 技能列表动态显示
- [ ] 统计数据实时更新

### Phase 4: 高级功能 (预计3-4天)

#### ✅ TODO 4.1: 文章详情页面
- [ ] 创建文章详情组件
- [ ] 实现文章内容展示
- [ ] 添加相关文章推荐
- [ ] 点赞和浏览量功能

#### ✅ TODO 4.2: 文章管理后台
- [ ] 创建文章编辑器页面
- [ ] 文章新增功能
- [ ] 文章编辑功能
- [ ] 文章删除功能
- [ ] 富文本编辑器集成

#### ✅ TODO 4.3: 标签和分类管理
- [ ] 标签管理页面
- [ ] 动态标签创建
- [ ] 标签统计展示

### Phase 5: 优化和测试 (预计2-3天)

#### ✅ TODO 5.1: 性能优化
- [ ] 数据库查询优化
- [ ] 缓存机制实现
- [ ] 前端加载优化

#### ✅ TODO 5.2: 测试和调试
- [ ] API接口测试
- [ ] 前端功能测试
- [ ] 集成测试
- [ ] 错误处理完善

#### ✅ TODO 5.3: 数据迁移
- [ ] 准备测试数据
- [ ] 数据库初始化脚本
- [ ] 模拟数据生成

---

## 🛠️ 技术栈补充

### 后端新增依赖
```xml
<!-- 可能需要的额外依赖 -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-validation</artifactId>
</dependency>
<dependency>
    <groupId>com.github.pagehelper</groupId>
    <artifactId>pagehelper-spring-boot-starter</artifactId>
</dependency>
```

### 前端新增功能
- 分页组件
- 搜索组件
- 标签选择器
- 加载状态组件
- 错误处理组件

---

## 📈 验收标准

### 功能性验收
- [ ] 所有页面数据来源于数据库
- [ ] 搜索和筛选功能正常工作
- [ ] 文章管理功能完整可用
- [ ] 个人信息可以动态修改
- [ ] 统计数据实时准确

### 性能验收
- [ ] 页面加载时间 < 2秒
- [ ] API响应时间 < 500ms
- [ ] 搜索响应时间 < 1秒

### 用户体验验收
- [ ] 加载状态提示友好
- [ ] 错误信息清晰明确
- [ ] 界面响应及时
- [ ] 数据展示美观

---

## 🔄 项目管理

### 开发日志格式
每完成一个阶段后，将TODO项目更新为完成状态，并添加：
- ✅ 完成时间
- 🔧 实现细节
- 🐛 遇到的问题和解决方案
- 📝 重要代码片段
- 🎯 下一步计划

### 版本控制
- 每个Phase作为一个feature分支
- 完成后合并到develop分支
- 最终合并到main分支

---

*此文档将在开发过程中持续更新，记录每个阶段的进展和重要决策。*