# 个人博客系统数据库设计说明

## 📋 项目概述

本文档详细说明了基于 Vue3 + Spring Boot 的个人博客系统的数据库设计，包括表结构、字段定义、关系设计以及实施步骤。

---

## 🎯 设计目标

### 功能需求分析
根据前端组件分析，系统需要支持以下功能：
- ✅ 用户认证与授权
- ✅ 文章发布与管理  
- ✅ 标签分类系统
- ✅ 文章统计功能
- ✅ 个人资料管理
- ✅ 技能展示系统
- ✅ 系统配置管理

### 设计原则
- **标准化**：遵循数据库设计规范
- **可扩展性**：支持未来功能扩展
- **性能优化**：合理的索引设计
- **数据完整性**：严格的约束条件

---

## 📊 数据库架构图

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│    user     │    │   article   │    │     tag     │
│             │◄───┤             ├───►│             │
│ - id        │    │ - id        │    │ - id        │ 
│ - username  │    │ - title     │    │ - name      │
│ - password  │    │ - content   │    │ - color     │
│ - email     │    │ - author_id │    └─────────────┘
│ - avatar    │    │ - status    │           │
│ ...         │    │ ...         │           │
└─────────────┘    └─────────────┘           │
       │                  │                  │
       │                  └─────────┬────────┘
       │                           │
       ▼                           ▼
┌─────────────┐              ┌─────────────┐
│   profile   │              │ article_tag │
│             │              │             │
│ - user_id   │              │ - article_id│
│ - nickname  │              │ - tag_id    │
│ - bio       │              └─────────────┘
│ - location  │              ┌─────────────┐
│ ...         │              │article_stats│
└─────────────┘              │             │
       │                     │ - article_id│
       ▼                     │ - views     │
┌─────────────┐              │ - likes     │
│    skill    │              │ - comments  │
│             │              └─────────────┘
│ - id        │              ┌─────────────┐
│ - user_id   │              │system_config│
│ - name      │              │             │
│ - level     │              │ - config_key│
└─────────────┘              │ - config_val│
                             └─────────────┘
```

---

## 🗄️ 表结构设计

### 1. 用户基础表 (user)

**功能说明**：存储用户基本认证信息

```sql
CREATE TABLE `user` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '用户ID',
  `username` varchar(50) NOT NULL COMMENT '用户名',
  `password` varchar(255) NOT NULL COMMENT '密码',
  `email` varchar(100) DEFAULT NULL COMMENT '邮箱',
  `avatar` varchar(255) DEFAULT NULL COMMENT '头像URL',
  `status` tinyint DEFAULT '1' COMMENT '状态：1-正常，0-禁用',
  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_username` (`username`),
  UNIQUE KEY `uk_email` (`email`),
  KEY `idx_status` (`status`),
  KEY `idx_created_at` (`created_at`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='用户基础表';
```

**字段说明**：
- `id`: 主键，自增长
- `username`: 用户名，唯一索引
- `password`: 密码（建议加密存储）
- `email`: 邮箱，支持找回密码功能
- `avatar`: 头像图片URL
- `status`: 账户状态，支持禁用功能

### 2. 用户资料表 (profile)

**功能说明**：存储用户详细个人信息

```sql
CREATE TABLE `profile` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '资料ID',
  `user_id` bigint NOT NULL COMMENT '用户ID',
  `nickname` varchar(50) DEFAULT NULL COMMENT '昵称',
  `real_name` varchar(50) DEFAULT NULL COMMENT '真实姓名',
  `bio` text COMMENT '个人简介',
  `job_title` varchar(100) DEFAULT NULL COMMENT '职位标题',
  `company` varchar(100) DEFAULT NULL COMMENT '公司',
  `location` varchar(100) DEFAULT NULL COMMENT '所在地',
  `website` varchar(255) DEFAULT NULL COMMENT '个人网站',
  `github` varchar(255) DEFAULT NULL COMMENT 'GitHub地址',
  `linkedin` varchar(255) DEFAULT NULL COMMENT 'LinkedIn地址',
  `twitter` varchar(255) DEFAULT NULL COMMENT 'Twitter地址',
  `motto` varchar(255) DEFAULT NULL COMMENT '个人座右铭',
  `years_experience` int DEFAULT '0' COMMENT '工作年限',
  `project_count` int DEFAULT '0' COMMENT '项目数量',
  `article_count` int DEFAULT '0' COMMENT '文章数量',
  `code_commits` int DEFAULT '0' COMMENT '代码提交数',
  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_user_id` (`user_id`),
  KEY `idx_nickname` (`nickname`),
  CONSTRAINT `fk_profile_user_id` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='用户资料表';
```

### 3. 技能表 (skill)

**功能说明**：存储用户技能信息

```sql
CREATE TABLE `skill` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '技能ID',
  `user_id` bigint NOT NULL COMMENT '用户ID',
  `name` varchar(50) NOT NULL COMMENT '技能名称',
  `level` int DEFAULT '0' COMMENT '技能等级(0-100)',
  `category` varchar(50) DEFAULT NULL COMMENT '技能分类',
  `description` text COMMENT '技能描述',
  `sort_order` int DEFAULT '0' COMMENT '排序顺序',
  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_category` (`category`),
  KEY `idx_sort_order` (`sort_order`),
  CONSTRAINT `fk_skill_user_id` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='技能表';
```

### 4. 文章表 (article)

**功能说明**：存储博客文章信息

```sql
CREATE TABLE `article` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '文章ID',
  `title` varchar(200) NOT NULL COMMENT '文章标题',
  `summary` varchar(500) DEFAULT NULL COMMENT '文章摘要',
  `content` longtext NOT NULL COMMENT '文章内容',
  `author_id` bigint NOT NULL COMMENT '作者ID',
  `status` tinyint DEFAULT '1' COMMENT '状态：1-发布，0-草稿，-1-删除',
  `read_time` int DEFAULT '0' COMMENT '预估阅读时间(分钟)',
  `cover_image` varchar(255) DEFAULT NULL COMMENT '封面图片',
  `is_top` tinyint DEFAULT '0' COMMENT '是否置顶：1-是，0-否',
  `allow_comment` tinyint DEFAULT '1' COMMENT '是否允许评论：1-是，0-否',
  `published_at` timestamp NULL DEFAULT NULL COMMENT '发布时间',
  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  KEY `idx_author_id` (`author_id`),
  KEY `idx_status` (`status`),
  KEY `idx_published_at` (`published_at`),
  KEY `idx_is_top` (`is_top`),
  KEY `idx_created_at` (`created_at`),
  FULLTEXT KEY `ft_title_content` (`title`,`content`),
  CONSTRAINT `fk_article_author_id` FOREIGN KEY (`author_id`) REFERENCES `user` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='文章表';
```

### 5. 标签表 (tag)

**功能说明**：存储文章标签信息

```sql
CREATE TABLE `tag` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '标签ID',
  `name` varchar(50) NOT NULL COMMENT '标签名称',
  `color` varchar(20) DEFAULT '#667eea' COMMENT '标签颜色',
  `description` varchar(255) DEFAULT NULL COMMENT '标签描述',
  `article_count` int DEFAULT '0' COMMENT '文章数量',
  `sort_order` int DEFAULT '0' COMMENT '排序顺序',
  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_name` (`name`),
  KEY `idx_article_count` (`article_count`),
  KEY `idx_sort_order` (`sort_order`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='标签表';
```

### 6. 文章标签关联表 (article_tag)

**功能说明**：文章与标签的多对多关系

```sql
CREATE TABLE `article_tag` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '关联ID',
  `article_id` bigint NOT NULL COMMENT '文章ID',
  `tag_id` bigint NOT NULL COMMENT '标签ID',
  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_article_tag` (`article_id`,`tag_id`),
  KEY `idx_article_id` (`article_id`),
  KEY `idx_tag_id` (`tag_id`),
  CONSTRAINT `fk_article_tag_article_id` FOREIGN KEY (`article_id`) REFERENCES `article` (`id`) ON DELETE CASCADE,
  CONSTRAINT `fk_article_tag_tag_id` FOREIGN KEY (`tag_id`) REFERENCES `tag` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='文章标签关联表';
```

### 7. 文章统计表 (article_stats)

**功能说明**：存储文章的统计数据

```sql
CREATE TABLE `article_stats` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '统计ID',
  `article_id` bigint NOT NULL COMMENT '文章ID',
  `view_count` int DEFAULT '0' COMMENT '浏览次数',
  `like_count` int DEFAULT '0' COMMENT '点赞次数',
  `comment_count` int DEFAULT '0' COMMENT '评论次数',
  `share_count` int DEFAULT '0' COMMENT '分享次数',
  `collect_count` int DEFAULT '0' COMMENT '收藏次数',
  `last_view_at` timestamp NULL DEFAULT NULL COMMENT '最后浏览时间',
  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_article_id` (`article_id`),
  KEY `idx_view_count` (`view_count`),
  KEY `idx_like_count` (`like_count`),
  KEY `idx_last_view_at` (`last_view_at`),
  CONSTRAINT `fk_article_stats_article_id` FOREIGN KEY (`article_id`) REFERENCES `article` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='文章统计表';
```

### 8. 系统配置表 (system_config)

**功能说明**：存储系统配置信息

```sql
CREATE TABLE `system_config` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '配置ID',
  `config_key` varchar(100) NOT NULL COMMENT '配置键',
  `config_value` text COMMENT '配置值',
  `config_type` varchar(20) DEFAULT 'string' COMMENT '配置类型',
  `description` varchar(255) DEFAULT NULL COMMENT '配置描述',
  `category` varchar(50) DEFAULT 'system' COMMENT '配置分类',
  `is_editable` tinyint DEFAULT '1' COMMENT '是否可编辑：1-是，0-否',
  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_config_key` (`config_key`),
  KEY `idx_category` (`category`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='系统配置表';
```

---

## 🚀 实施步骤

### 第一步：了解项目，设计数据库表结构 ✅

**任务说明**：
- ✅ 分析前端组件功能需求
- ✅ 设计完整的数据库表结构
- ✅ 编写详细的设计文档

### 第二步：创建数据库和基础表

**任务内容**：
1. 创建数据库
2. 执行建表SQL脚本
3. 插入初始化数据
4. 验证表结构正确性

### 第三步：扩展用户实体类

**任务内容**：
1. 更新现有User实体
2. 创建Profile实体
3. 创建Skill实体
4. 配置实体关系

### 第四步：创建文章相关实体

**任务内容**：
1. 创建Article实体
2. 创建Tag实体
3. 创建ArticleTag关联实体
4. 创建ArticleStats实体

### 第五步：创建Repository层

**任务内容**：
1. 扩展UserRepository
2. 创建ArticleRepository
3. 创建TagRepository
4. 创建ProfileRepository
5. 创建SkillRepository

### 第六步：实现Service层

**任务内容**：
1. 扩展UserService
2. 创建ArticleService
3. 创建TagService
4. 创建ProfileService
5. 创建StatisticsService

### 第七步：实现Controller层

**任务内容**：
1. 扩展UserController
2. 创建ArticleController
3. 创建TagController
4. 创建ProfileController

### 第八步：前端集成

**任务内容**：
1. 更新前端API调用
2. 实现动态数据展示
3. 添加数据管理功能
4. 完善用户交互

---

## 📝 初始化数据脚本

### 系统配置初始数据

```sql
INSERT INTO `system_config` (`config_key`, `config_value`, `config_type`, `description`, `category`) VALUES
('site_title', '我的个人博客', 'string', '网站标题', 'site'),
('site_description', '用心记录技术成长之路', 'string', '网站描述', 'site'),
('site_keywords', 'Vue,Spring Boot,全栈开发,技术博客', 'string', '网站关键词', 'site'),
('admin_email', 'admin@example.com', 'string', '管理员邮箱', 'admin'),
('articles_per_page', '10', 'number', '每页文章数', 'pagination'),
('comment_enabled', '1', 'boolean', '是否启用评论', 'feature'),
('registration_enabled', '1', 'boolean', '是否允许注册', 'feature');
```

### 默认标签数据

```sql
INSERT INTO `tag` (`name`, `color`, `description`) VALUES
('Vue.js', '#4FC08D', '渐进式JavaScript框架'),
('Spring Boot', '#6DB33F', 'Java企业级应用框架'),
('JavaScript', '#F7DF1E', 'Web前端编程语言'),
('MySQL', '#4479A1', '关系型数据库管理系统'),
('全栈开发', '#667eea', '前后端全栈技术'),
('前端开发', '#61DAFB', '前端技术相关'),
('后端开发', '#ED8B00', '后端技术相关'),
('数据库', '#336791', '数据库相关技术'),
('性能优化', '#FF6B6B', '性能优化相关'),
('项目实战', '#4ECDC4', '实际项目开发经验');
```

---

## 🔍 查询示例

### 常用查询语句

```sql
-- 1. 获取用户完整信息
SELECT 
  u.id, u.username, u.email, u.avatar,
  p.nickname, p.bio, p.job_title, p.years_experience
FROM user u
LEFT JOIN profile p ON u.id = p.user_id
WHERE u.id = 1;

-- 2. 获取文章列表（包含标签）
SELECT 
  a.id, a.title, a.summary, a.published_at,
  GROUP_CONCAT(t.name) as tags,
  s.view_count, s.like_count, s.comment_count
FROM article a
LEFT JOIN article_tag at ON a.id = at.article_id
LEFT JOIN tag t ON at.tag_id = t.id
LEFT JOIN article_stats s ON a.id = s.article_id
WHERE a.status = 1
GROUP BY a.id
ORDER BY a.published_at DESC;

-- 3. 获取热门标签
SELECT t.name, t.color, t.article_count
FROM tag t
WHERE t.article_count > 0
ORDER BY t.article_count DESC
LIMIT 10;

-- 4. 获取文章统计数据
SELECT 
  COUNT(*) as total_articles,
  SUM(s.view_count) as total_views,
  SUM(s.like_count) as total_likes
FROM article a
LEFT JOIN article_stats s ON a.id = s.article_id
WHERE a.status = 1;
```

---

## ⚡ 性能优化建议

### 索引优化
1. **主键索引**：所有表都有自增主键
2. **唯一索引**：用户名、邮箱等唯一字段
3. **外键索引**：关联查询字段
4. **复合索引**：多条件查询字段组合
5. **全文索引**：文章标题和内容搜索

### 查询优化
1. **分页查询**：使用LIMIT避免大数据量查询
2. **延迟加载**：按需加载关联数据
3. **缓存策略**：热点数据Redis缓存
4. **读写分离**：读多写少场景优化

### 数据归档
1. **软删除**：重要数据逻辑删除
2. **数据归档**：定期归档历史数据
3. **日志分离**：访问日志独立存储

---

## 🛡️ 安全考虑

### 数据安全
1. **密码加密**：使用BCrypt加密存储
2. **SQL注入防护**：使用参数化查询
3. **XSS防护**：输入数据转义处理
4. **权限控制**：基于角色的访问控制

### 数据备份
1. **定期备份**：数据库定期全量备份
2. **增量备份**：重要表增量备份
3. **异地备份**：多地备份策略
4. **恢复测试**：定期验证备份可用性

---

## 📚 后续扩展计划

### 功能扩展
1. **评论系统**：文章评论和回复功能
2. **用户权限**：管理员、编辑、读者角色
3. **文件管理**：图片和文档上传管理
4. **搜索引擎**：全文搜索和高级筛选
5. **消息通知**：实时消息推送系统

### 技术升级
1. **分布式缓存**：Redis集群部署
2. **搜索引擎**：ElasticSearch集成
3. **消息队列**：RabbitMQ异步处理
4. **微服务**：服务拆分和治理
5. **容器化**：Docker部署方案

---

*本文档将随着项目发展持续更新，确保数据库设计与业务需求保持同步。* 